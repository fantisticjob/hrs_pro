<?xml version="1.0" encoding="UTF-8"?>
<beans:beans  
        xmlns="http://www.springframework.org/schema/security"  
        xmlns:beans="http://www.springframework.org/schema/beans"
        xmlns:p="http://www.springframework.org/schema/p"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"  
        xmlns:context="http://www.springframework.org/schema/context"  
        xsi:schemaLocation="http://www.springframework.org/schema/beans  
          http://www.springframework.org/schema/beans/spring-beans.xsd  
          http://www.springframework.org/schema/context  
          http://www.springframework.org/schema/context/spring-context.xsd  
          http://www.springframework.org/schema/security  
              http://www.springframework.org/schema/security/spring-security.xsd"> 
     
    <!-- 不拦截登录界面和js,css等资源  -->
    <!-- 不拦截登录界面和js,css等资源  -->
    <http pattern="/login.jsp" security="none"/>
    <http pattern="/views/common/**" security="none"/>
    <http pattern="/resources/css/**" security="none"/>
    <http pattern="/resources/css/fancybox/**" security="none"/>
    <http pattern="/resources/css/images/**" security="none"/>
    <http pattern="../resources/easyui/**" security="none"/>
    <http pattern="/resources/js/**" security="none"/>
    <http pattern="/resources/**" security="none"/>
    <http pattern="../../../**/*.png" security="none"/>
    <http pattern="../../../**/*.jpg" security="none"/>
    <http pattern="../../../**/*.gif" security="none"/>
    <http pattern="../../**/*.htm*" security="none"/>
    <http pattern="../../../**/*.htm*" security="none"/>
    <http pattern="../**/*.css" security="none"/>
    <http pattern="../**/*.js" security="none"/>
    <http pattern="../**/*.swf" security="none"/>
    <http pattern="../**/*.json" security="none"/>
    <http pattern="../views/welcome.jsp" security="none"></http>
     
     <http auto-config="true" use-expressions="true">
        <csrf disabled="true" />
        <headers>
        	<frame-options policy="SAMEORIGIN"/>
        </headers>

        <!-- IS_AUTHENTICATED_ANONYMOUSLY 匿名登录 -->  
        <intercept-url pattern="/login.jsp" access="IS_AUTHENTICATED_ANONYMOUSLY" />
        <intercept-url pattern="../views/welcome.jsp" access="IS_AUTHENTICATED_ANONYMOUSLY" />
        <intercept-url pattern="/MainForm.jsp" access="hasRole('USER') or hasRole('ADMIN') or hasRole('DBA')"/>
		<!-- 页面登录 -->
		<form-login login-page="/login.jsp" login-processing-url="/userController/login.do"
					password-parameter="password" username-parameter="username"
					authentication-failure-url="/views/loginError.jsp" 
					default-target-url="/mainFrame/portal.do?"/>
		
		
		<!-- 退出登录 -->
       	<logout invalidate-session="true" logout-url="/userController/performLogout.do" logout-success-url="/" delete-cookies="JSESSIONID" />
       
		
		<!-- session管理 -->
        <session-management invalid-session-url="/userController/timedout.do" session-fixation-protection="none"
            session-authentication-error-url="/userController/timedout.do">
            <concurrency-control error-if-maximum-exceeded="true" expired-url="/userController/timedout.do"
                max-sessions="1" />
        </session-management> 
    </http>
  

    <!-- Select users and user_roles from database -->
    <authentication-manager  alias="authenticationManager">
		<authentication-provider user-service-ref="userLoginService">
			<password-encoder ref="passwordEncoderImpl"></password-encoder>
		</authentication-provider>
    </authentication-manager>  
   
   <beans:bean id="userLoginService" class="com.hausontech.hrs.serviceImpl.userManager.LoginUserServiceImpl"></beans:bean>
   <beans:bean id="passwordEncoderImpl" class="com.hausontech.hrs.serviceImpl.userManager.PasswordEncoderImpl"></beans:bean>
 </beans:beans>